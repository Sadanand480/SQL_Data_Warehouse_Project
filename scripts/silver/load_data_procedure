-- Insert into silver.cust_info
insert into silver.cust_info(
	cst_id,
	cst_key,
    cst_firstname,
    cst_lastname,
    cst_marital_status,
    cst_gndr,
    cst_create_date,
    etl_load_date)
select 
	cst_id,
    cst_key,
    cst_firstname,
    cst_lastname,
    cst_marital_status,
    cst_gndr,
    cst_create_date,
    current_timestamp
from bronze.cust_info;

-- Insert into Silver.Product Information-- 
insert into silver.prd_info(
	prd_id,
    prd_key,
    prd_nm,
    prd_cost,
    prd_line,
    prd_start_dt, 
	prd_start_dt_0,
    etl_load_date)
select 
	prd_id,
    prd_key,
    prd_nm,
    prd_cost,
    prd_line,
    prd_start_dt,
    prd_start_dt_0,
    current_timestamp

-- Insert into Silver.Sales Details-- 
insert into silver.sales_details(
	sls_ord_num,
    sls_prd_key, 
    sls_cust_id, 
	sls_order_dt,
    sls_ship_dt, 
    sls_due_dt, 
    sls_sales, 
    sls_quantity, 
    sls_price,
    etl_load_date)
select
	sls_ord_num,
    sls_prd_key, 
    sls_cust_id, 
	sls_order_dt,
    sls_ship_dt, 
    sls_due_dt, 
    sls_sales, 
    sls_quantity, 
    sls_price,
	current_timestamp
from bronze.sales_details;

-- Insert into Silver.loc_a101-- 
insert into silver.loc_a101(
	CID,
	CNTRY,
	etl_load_date)
select
	CID,
	CNTRY,
	current_timestamp
from bronze.loc_a101;
from bronze.prd_info;

-- Insert into Silver.Customer az12-- 
insert into silver.cust_az12(
	CID,
    BDATE,
    GEN,
    etl_load_date)
select
	CID,
    BDATE,
    GEN,
    current_timestamp
from bronze.cust_az12;

-- Insert into Silver.px_cat_g1v2-- 
insert into silver.px_cat_g1v2(
	ID,
    CAT,
    SUBCAT,
    MAINTENANCE,
    etl_load_date)
select
	ID,
    CAT,
    SUBCAT,
    MAINTENANCE,
    current_timestamp
from bronze.px_cat_g1v2;

-- Stored Procedure: Load Bronze Layer (Source -> Bronze)-- 
delimiter $$
create procedure silver.load_silver()
begin
	select * from silver.cust_info;
    select * from silver.prd_info;
    select * from silver.sales_details;
    select * from silver.cust_az12;
    select * from silver.loc_a101;
    select * from silver.px_cat_g1v2;
end$$
delimiter ;
